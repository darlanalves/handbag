!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.handbag=t()}(this,function(){"use strict";var e={};e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},e.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var t=Object.prototype.toString,n={},r="This injector is frozen and cannot be modified",i={array:function(e){return"[object Array]"===t.call(e)},"function":function(e){return"function"==typeof e},object:function(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":e["typeof"](t))}},o=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,a=function(){function t(){e.classCallCheck(this,t),this._reset()}return e.createClass(t,[{key:"get",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(i.array(e))return e.map(function(e){return this.get(e,t)},this);if("handbag"===e)return this;var n=t.hasOwnProperty(e);if(n||"function"!=typeof t.getOwnPropertySymbols||(n=-1!==t.getOwnPropertySymbols().indexOf(e)),n)return t[e];var r=this.$stack;if(!this.has(e)){var o="Dependency not found: "+e+(r.length?" ("+r.join(" <- ")+")":"");throw new Error(o)}return this._getResource(e,t)}},{key:"_getResource",value:function(e,t){if(this.hasLocalProvider(e))return this.getOrCreate(e,t);var n=this.$children.find(function(t){return t.hasLocalProvider(e)});return n.getOrCreate(e,t)}},{key:"getOrCreate",value:function(e,t){var r=this.$cache,i=this.$stack,o=this.$providers;if(r.has(e)&&!this._isInstantiating(e))return r.get(e);var a=void 0,s=void 0;i.push(e);try{if(this._isInstantiating(e))throw new Error("Circular dependency found: "+i.join(" <- "));r.set(e,n),s=this.instantiate(o.get(e),t),r.set(e,s)}catch(u){this._isInstantiating(e)&&r["delete"](e),a=u}finally{i.pop()}if(a)throw a;return!0===this.$privates[e]&&r["delete"](e),console.log(e,s),s}},{key:"_isInstantiating",value:function(e){return this.$cache.get(e)===n}},{key:"has",value:function(e){return this.hasLocalProvider(e)||this.hasChildProvider(e)}},{key:"hasLocalProvider",value:function(e){var t=this.$cache.has(e)||this.$providers.has(e);return t}},{key:"hasChildProvider",value:function(e){var t=Boolean(this.$children.find(function(t){return t.hasLocalProvider(e)}));return t}},{key:"provideShared",value:function(e,t){return this.provide(e,t,!0)}},{key:"provideNotShared",value:function(e,t){return this.provide(e,t,!1)}},{key:"provide",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];if(this.$frozen)throw new Error(r);if(i.array(t)){var o=t[t.length-1];if(!i["function"](o))throw new Error("Invalid provider for "+e);return this._register(e,t,n),this}if(i["function"](t)){var a=this._parseDependencies(t);return a.push(t),this._register(e,a,n),this}return this.constant(e,t),this}},{key:"constant",value:function(e,t){if(this.$frozen)throw new Error(r);return this.$cache.set(e,t),this}},{key:"instantiate",value:function(e,t){var n,r,o=function(){};return o.prototype=(i.array(e)?e[e.length-1]:e).prototype,n=new o,r=this.invoke(e,n,t),n=i.object(r)||i["function"](r)?r:n}},{key:"invoke",value:function(e,t,n){var r=void 0;if(i.array(e)?r=this._getInvokableFromArray(e):i["function"](e)&&(r=this._getInvokableFromFunction(e)),!r||!r.method)throw new Error("Invalid invokable value");var o=r,a=o.dependencies;return a.length&&(a=this.get(a,n)),r.method.apply(t||null,a)}},{key:"_getInvokableFromArray",value:function(e){var t=e.slice(0),n=t.pop();return i["function"](n)||(n=null),{dependencies:t,method:n}}},{key:"_getInvokableFromFunction",value:function(e){var t=e.$inject||this._parseDependencies(e);return{dependencies:t,method:e}}},{key:"_annotateConstructor",value:function(){var e=Array.from(arguments),t=e.pop();return t.$inject=e,t}},{key:"_parseDependencies",value:function(e){var t=e.toString().match(o),n=t&&t[1];return n&&n.split(",").map(function(e){return e.trim()})||[]}},{key:"_register",value:function(e,t,n){if(this.$providers.has(e))throw new Error("Cannot register a dependency that already exists: "+e);var r=this._annotateConstructor.apply(null,t);this.$providers.set(e,r),n||(this.$privates[e]=!0)}},{key:"freeze",value:function(){this.$frozen=!0}},{key:"_reset",value:function(){this.$cache=new Map,this.$providers=new Map,this.$privates={},this.$stack=[],this.$children=[]}},{key:"addInjector",value:function(e){this.$children.push(e)}}],[{key:"createInjector",value:function(){return new t}}]),t}();return a});
//# sourceMappingURL=handbag.min.js.map